题目编号：364

题目：加权嵌套序列和 II

难度：中等

考察范围：深度优先搜索、递归、树

题干：给定一个嵌套的整数列表，请返回该列表按深度加权后所有整数的总和。

每个元素可能是一个整数或一个列表（其元素也可能是整数或列表）。

列表的深度从1开始，每增加一层，深度增加1。例如，列表 [1, [4, [6]]] 的深度为3；而 [1, [4, [6]]] 的深度为1。

示例 1：
输入：[[1,1],2,[1,1]]
输出：10 
解释：四个元素分别是：
1. 一个包含两个整数的嵌套列表 [[1,1]]
2. 一个整数 2
3. 一个包含两个整数的嵌套列表 [[1,1]]
4. 一个整数 1
按深度加权后的扁平列表如下：
1. 一个包含两个整数的嵌套列表 [[1,1]]，深度为 2，所以加权为 2 * (1 + 1) = 4
2. 一个整数 2，深度为 1，所以加权为 1 * 2 = 2
3. 一个包含两个整数的嵌套列表 [[1,1]]，深度为 2，所以加权为 2 * (1 + 1) = 4
4. 一个整数 1，深度为 1，所以加权为 1 * 1 = 1
加起来得到 4 + 2 + 4 + 1 = 11。

解题思路：本题可以使用深度优先搜索（DFS）来解决。对于每个元素，如果是整数，则直接加上其深度乘以该整数的值；如果是列表，则递归调用 DFS 函数，将深度加一，将列表作为参数传入。

解决方案：

```ruby
def depth_sum(nested_list)
  dfs(nested_list, 1)
end

def dfs(nested_list, depth)
  sum = 0
  nested_list.each do |item|
    if item.is_a?(Integer)
      sum += item * depth
    else
      sum += dfs(item, depth + 1)
    end
  end
  sum
end
```

算法复杂度：时间复杂度为 O(n)，其中 n 为列表中元素的个数，因为每个元素只会被遍历一次；空间复杂度为 O(d)，其中 d 为列表的最大深度，因为递归调用时会有 d 层函数调用栈。