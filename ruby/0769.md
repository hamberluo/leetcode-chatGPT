题目编号：769

题目：最多能完成排序的块

难度：中等

考察范围：数组、排序

题干：

给定一个数组arr，其中有一些元素重复出现，但是每个元素的值都不相同。我们需要对这个数组进行排序，但是我们只能对某些块进行排序。块是一些相邻的元素，这些元素在原数组中的相对位置是固定的。

我们需要最多的排序块数量，并返回这个最大值。

解题思路：

首先，我们需要明确一点，对于一个块内的元素，它们的相对位置是固定的，所以如果一个块内的元素是有序的，那么这个块就不需要再排序了。

接下来，我们考虑如何划分块。我们可以从左到右遍历数组，同时记录当前遍历到的最大值max，如果当前位置i的值等于i，那么这个位置就是一个块的结尾，因为它后面的元素都比它大，所以它不能和后面的元素组成一个块。如果当前位置i的值大于max，那么这个位置也是一个块的结尾，因为它后面的元素都比它小，所以它不能和后面的元素组成一个块。如果当前位置i的值小于max，那么它可以和后面的元素组成一个块。

最后，我们统计一下块的数量即可。

解决方案：

```ruby
def max_chunks_to_sorted(arr)
  max = 0
  count = 0
  arr.each_with_index do |num, i|
    max = [max, num].max
    count += 1 if max == i
  end
  count
end
```

算法复杂度：时间复杂度为O(n)，空间复杂度为O(1)。