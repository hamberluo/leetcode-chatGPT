题目编号：294

题目：翻转游戏 II

难度：中等

考察范围：回溯算法

题干：你和朋友玩一个叫做「翻转游戏」的游戏，游戏规则如下：

给你一个字符串 currentState ，其中只含 '+' 和 '-' 。
你和朋友轮流将 连续 的两个 "++" 反转成 "--" 。当一方无法进行有效的翻转时便意味着游戏结束，则另一方获胜。
计算并返回 一次有效操作 后，字符串 currentState 所有的可能状态，返回结果可以任意顺序排列。如果不存在可能的有效操作，请返回一个空列表 [] 。

解题思路：回溯算法

回溯算法是一种通过穷举所有可能情况来找到所有解的算法。如果一个候选解最后被发现并不是可行解，回溯算法会舍弃它，而在前面的一些步骤做出一些修改，并重新尝试找到可行解。

对于本题，我们可以通过回溯算法来穷举所有可能的情况，找到所有可行解。

具体实现思路如下：

- 遍历字符串，找到连续的两个 '+'，将其翻转成 '--'，并将新的字符串加入结果集中。
- 回溯到上一步，将翻转后的字符串再翻转回去，恢复原来的状态。
- 继续遍历字符串，找到下一个连续的两个 '+'，重复上述步骤。

解决方案：

```ruby
# @param {String} s
# @return {String[]}
def generate_possible_next_moves(s)
  res = []
  backtrack(s, res)
  res
end

def backtrack(s, res)
  (0..s.length-2).each do |i|
    if s[i] == '+' && s[i+1] == '+'
      s[i] = '-'
      s[i+1] = '-'
      res << s.dup
      backtrack(s, res)
      s[i] = '+'
      s[i+1] = '+'
    end
  end
end
```

算法复杂度：时间复杂度为 O(n^2)，空间复杂度为 O(n)，其中 n 为字符串的长度。