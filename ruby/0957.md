题目编号：957

题目：N 天后的牢房

难度：中等

考察范围：模拟、哈希表

题干：8 个牢房排成一排，每间牢房不是有人住就是空着。

每天，无论牢房是被占用或空置，都会根据以下规则进行更改：

如果一间牢房两边都被占用或都是空的，那么该牢房将变成占用的。
否则，它将变成空的。

（请注意，由于牢房的状态也会随着时间的推移而发生变化，因此某些牢房可能在不同时刻处于不同的状态）

如果第一天所有牢房都是空的，那么第二天所有牢房都会变成占用的。

给定表示牢房当前状态的长度为 8 的数组 cells 和一个表示天数的正整数 N，请你计算并返回牢房在 N 天后的状态。

解题思路：由于牢房的数量较少，可以直接模拟每一天的变化，使用哈希表记录每一天的状态，如果出现了重复的状态，则说明出现了循环，可以直接跳过后面的天数。

解决方案：

```ruby
def prison_after_n_days(cells, n)
  # 哈希表记录每一天的状态
  hash = {}
  while n > 0
    # 如果当前状态已经出现过，则说明出现了循环，可以直接跳过后面的天数
    if hash[cells]
      n %= hash[cells] - n
    end
    # 记录当前状态
    hash[cells] = n
    # 模拟一天的变化
    cells = next_day(cells)
    n -= 1
  end
  cells
end

# 计算下一天的状态
def next_day(cells)
  new_cells = [0] * cells.size
  (1..cells.size-2).each do |i|
    if cells[i-1] == cells[i+1]
      new_cells[i] = 1
    end
  end
  new_cells
end
```

算法复杂度：时间复杂度为 O(2^N)，空间复杂度为 O(2^N)。由于牢房的数量较少，可以通过本题。