题目编号：910

题目：最小差值 II

难度：中等

考察范围：二分查找、贪心算法

题干：给定一个整数数组 A，对于每个整数 A[i]，我们可以选择 x = -K 或是 x = K，并将 x 加到 A[i] 中。在此过程之后，我们得到一些数组 B。返回 B 的最大值和 B 的最小值之间可能存在的最小差值。

解题思路：本题可以使用二分查找和贪心算法相结合的思路来解决。首先对数组 A 进行排序，然后对于每个 A[i]，我们可以选择将其加上 K 或者减去 K，这样得到的数组 B 的最大值和最小值之间的差值就是 A[i] 加上或减去 K 后得到的最大值和最小值之间的差值。因此，我们可以枚举 K 的值，然后对于每个 K，计算得到数组 B 的最大值和最小值之间的差值，最后取所有差值中的最小值即可。

解决方案：

```ruby
def smallest_range_ii(a, k)
  a.sort!
  n = a.size
  ans = a[-1] - a[0]
  (0...n-1).each do |i|
    max_val = [a[i] + k, a[-1] - k].max
    min_val = [a[0] + k, a[i+1] - k].min
    ans = [ans, max_val - min_val].min
  end
  ans
end
```

算法复杂度：时间复杂度为 O(nlogn)，空间复杂度为 O(1)。