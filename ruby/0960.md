题目编号：960

题目：删列造序 III

难度：中等

考察范围：动态规划

题干：给定由 N 个小写字母字符串组成的数组 A，其中每个字符串长度相等。 选取一个删除索引序列，对于 A 中的每个字符串，删除对应每个索引处的字符。 比如，有 A = ["abcdef", "uvwxyz"]，删除索引序列 {0, 2, 3}，删除后 A[0] = "bef", A[1] = "wxyz"。 假设，我们选择了一组删除索引 D，在执行删除操作之后，A 中剩余的每一列都是非降序排列的，那么称 D 是关键删列集合。 返回 A 中关键删列集合的最小可能大小。

解题思路：这道题可以用动态规划来解决。我们定义 dp[i] 表示以第 i 列为结尾的关键删列集合的最小可能大小。对于第 i 列，我们需要考虑两种情况：

- 不删除第 i 列，那么 dp[i] 就等于 dp[i-1]。
- 删除第 i 列，那么我们需要找到一个 j，使得对于所有的 k，都有 A[k][i] <= A[k][j]，然后 dp[i] 就等于 dp[j] + 1。

最终的答案就是 dp[N-1]。

解决方案：

```ruby
def min_deletion_size(a)
  n = a[0].size
  dp = Array.new(n, 1)
  (1...n).each do |i|
    (0...i).each do |j|
      if (0...a.size).all? { |k| a[k][j] <= a[k][i] }
        dp[i] = [dp[i], dp[j]+1].min
      end
    end
  end
  n - dp.max
end
```

算法复杂度：时间复杂度为 O(n^2)，空间复杂度为 O(n)。