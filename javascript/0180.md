题目编号：180

题目：Consecutive Numbers

难度：Medium

考察范围：SQL

题干：编写一个 SQL 查询，查找所有至少连续出现三次的数字。

表格 Logs 的每行都有一个 id，该 id 由连续的序列组成，Logs 表格中的每个数字都表示一个独立的日志片段。

例如，如果表格 Logs 为：

+----+-----+
| Id | Num |
+----+-----+
| 1  |  1  |
| 2  |  1  |
| 3  |  1  |
| 4  |  2  |
| 5  |  1  |
| 6  |  2  |
| 7  |  2  |
+----+-----+

则表示 1 被连续出现了 3 次，2 被连续出现了 1 次，1 又被连续出现了 1 次。

解题思路：使用窗口函数，将相邻的数字分为一组，然后统计每组的数量，最后筛选出数量大于等于3的组。

解决方案：

```sql
SELECT DISTINCT l1.Num
FROM Logs l1, Logs l2, Logs l3
WHERE l1.Num = l2.Num AND l2.Num = l3.Num
AND l1.Id = l2.Id - 1 AND l2.Id = l3.Id - 1;
```

算法复杂度：时间复杂度为 O(n^3)，空间复杂度为 O(1)。