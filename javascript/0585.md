题目编号：585

题目：查询订单

难度：简单

考察范围：SQL

题干：有一个订单表，包含了订单的 id、日期、金额和客户 id。

请你编写一个 SQL 查询，查询每个客户的订单总金额，并按照金额从高到低进行排序。

表格格式如下：

Table: Orders

+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| order_id    | int     |
| customer_id | int     |
| order_date  | date    |
| amount      | int     |
+-------------+---------+
order_id 是表的主键。

例如样例输入中的表格：

Orders 表：
+----------+-------------+------------+--------+
| order_id | customer_id | order_date | amount |
+----------+-------------+------------+--------+
| 1        | 1           | 2020-06-01 | 1000   |
| 2        | 2           | 2020-06-02 | 2000   |
| 3        | 3           | 2020-06-03 | 3000   |
| 4        | 1           | 2020-06-04 | 4000   |
| 5        | 2           | 2020-06-05 | 5000   |
| 6        | 3           | 2020-06-06 | 6000   |
+----------+-------------+------------+--------+

样例输出：

+-------------+-------------+
| customer_id | total_amount|
+-------------+-------------+
| 3           | 9000        |
| 2           | 7000        |
| 1           | 5000        |
+-------------+-------------+

解题思路：使用 GROUP BY 和 SUM 函数对订单表进行分组和求和，再按照总金额进行排序。

解决方案：

```sql
SELECT customer_id, SUM(amount) AS total_amount
FROM Orders
GROUP BY customer_id
ORDER BY total_amount DESC
```

算法复杂度：时间复杂度 O(nlogn)，空间复杂度 O(n)。