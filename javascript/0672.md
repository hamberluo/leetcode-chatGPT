题目编号：672

题目：灯泡开关 Ⅱ

难度：中等

考察范围：数学、逻辑

题干：现有一个房间，墙上挂有 n 只已经打开的灯泡和 4 个按钮。在进行了 m 次未知操作后，你需要返回这 n 只灯泡可能有多少种不同的状态。假设这 n 只灯泡初始状态都是关闭的。

操作1：将所有灯泡的状态反转（即开变为关，关变为开）
操作2：将偶数编号的灯泡的状态反转
操作3：将奇数编号的灯泡的状态反转
操作4：将编号为 3k+1 的灯泡的状态反转（k = 0, 1, 2, ...)

解题思路：通过观察题目，我们可以发现，操作1和操作2、3是等价的，操作4是操作2、3的推广。因此，我们只需要考虑操作2、3、4的情况即可。

对于操作2、3，我们可以发现，每次操作只会改变偶数或奇数位置的灯泡状态，因此，我们可以分别考虑偶数位置和奇数位置的灯泡状态，最后将两者相乘即可。

对于操作4，我们可以发现，每次操作只会改变编号为 3k+1 的灯泡状态，因此，我们可以分别考虑编号为 1、4、7、...、3k+1、...的灯泡状态，最后将所有情况相乘即可。

解决方案：

```javascript
var flipLights = function(n, m) {
    if (m === 0) return 1; // 没有操作，灯泡状态不变，只有一种情况
    if (n === 1) return 2; // 只有一盏灯泡，只有两种情况：开或关
    if (n === 2) return m === 1 ? 3 : 4; // 只有两盏灯泡，操作一次有三种情况，操作两次有四种情况
    if (m === 1) return n === 3 ? 4 : 7; // 只操作一次，分别考虑三种情况：n=3、n>3且为偶数、n>3且为奇数
    if (m === 2) return n === 3 ? 8 : n === 4 ? 8 : 14; // 操作两次，分别考虑三种情况：n=3、n=4、n>4
    return n === 3 ? 8 : n === 4 ? 12 : 20; // 操作三次及以上，分别考虑三种情况：n=3、n=4、n>4
};
```

算法复杂度：时间复杂度为 O(1)，空间复杂度为 O(1)。