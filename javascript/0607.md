题目编号：607

题目：销售员

难度：简单

考察范围：字符串操作

题干：给定一个 Sales 表，包含所有销售信息。每个顾客都有一个对应的 Id，而 Sales 表包含销售日期和该顾客的 Id。

+---------+------------+-------+
| sales_id|  sell_date |  price |
+---------+------------+-------+
| 1       | 2020-01-01 | 100   |
| 2       | 2020-01-01 | 200   |
| 3       | 2020-01-02 | 300   |
| 4       | 2020-01-02 | 400   |
+---------+------------+-------+
Id 为 1 的顾客在 "2020-01-01" 和 "2020-01-02" 两天内共购买了 2 次，用了 100 和 200。在 "2020-01-02" 这一天，他在购买前一天的账单中花了 100，所以此时他的总花费是 300。

解题思路：首先需要按照顾客 Id 和销售日期进行分组，然后对每个顾客的每个销售日期进行计算，得到该顾客在该销售日期的总花费。最后将结果按照顾客 Id 和销售日期进行排序，输出结果。

解决方案：

```javascript
SELECT s1.buyer_id, s1.sell_date, SUM(s2.price) AS total_amount
FROM Sales s1
JOIN Sales s2 ON s1.buyer_id = s2.buyer_id AND s1.sell_date >= s2.sell_date
GROUP BY s1.buyer_id, s1.sell_date
ORDER BY s1.buyer_id, s1.sell_date;
```

算法复杂度：时间复杂度为 O(nlogn)，空间复杂度为 O(n)。其中 n 为 Sales 表中的记录数。