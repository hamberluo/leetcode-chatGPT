题目编号：626

题目：换座位

难度：中等

考察范围：字符串、数组、模拟

题干：

小美是一所中学的信息科技老师，她有一张 seat 座位表，平时用来储存学生名字和与他们相对应的座位 id。

其中纵列的 id 是连续递增的

小美想改变相邻俩学生的座位。

你能不能帮她写一个 SQL query 来输出小美想要的结果呢？

示例：

+---------+---------+
|    id   | student |
+---------+---------+
|    1    | Abbot   |
|    2    | Doris   |
|    3    | Emerson |
|    4    | Green   |
|    5    | Jeames  |
+---------+---------+

假如数据输入的是上表，则输出结果如下：

+---------+---------+
|    id   | student |
+---------+---------+
|    1    | Doris   |
|    2    | Abbot   |
|    3    | Green   |
|    4    | Emerson |
|    5    | Jeames  |
+---------+---------+

注意：

如果学生人数是奇数，则不需要改变最后一个同学的座位。

解题思路：

题目要求交换相邻两个学生的座位，可以通过将座位表自连接来实现。

首先，将座位表按照 id 排序，然后将其自连接，连接条件为左表的 id 等于右表的 id+1，这样就可以得到相邻两个学生的信息。

接着，将左表的学生名字和右表的学生名字互换，就可以得到交换后的座位表。

最后，将交换后的座位表按照 id 排序输出即可。

解决方案：

```sql
SELECT
    IFNULL(t2.id, t1.id) AS id,
    IFNULL(t2.student, t1.student) AS student
FROM
    seat t1
    LEFT JOIN seat t2 ON t1.id = t2.id + 1
ORDER BY
    id ASC;
```

算法复杂度：时间复杂度 O(n)，空间复杂度 O(n)。其中 n 是座位表的长度。