题目编号：309

题目：最佳买卖股票时机含冷冻期

难度：中等

考察范围：动态规划

题干：给定一个整数数组，其中第 i 个元素代表了第 i 天的股票价格 。​设计一个算法计算出最大利润。在满足以下约束条件下，你可以尽可能地完成更多的交易（多次买卖一支股票）:

你不能同时持有多支股票，即必须在再次购买前出售掉之前的股票。
卖出股票后，你无法在第二天买入股票（即冷冻期为 1 天）。
示例：

输入: [1,2,3,0,2]
输出: 3 
解释: 对于给定的输入数组, 
在第 i 天买入股票有以下几种情况：
    (1)买入第 1 天，卖出第 2 天利润 = 1 - 2 = -1
    (2)买入第 1 天，卖出第 3 天利润 = 1 - 3 = -2
    (3)买入第 1 天，卖出第 4 天利润 = 1 - 0 = 1
    (4)买入第 1 天，卖出第 5 天利润 = 1 - 2 = -1
    (5)买入第 2 天，卖出第 3 天利润 = 2 - 3 = -1
    (6)买入第 2 天，卖出第 4 天利润 = 2 - 0 = 2
    (7)买入第 2 天，卖出第 5 天利润 = 2 - 2 = 0
    (8)买入第 3 天，卖出第 4 天利润 = 3 - 0 = 3
    (9)买入第 3 天，卖出第 5 天利润 = 3 - 2 = 1
    (10)买入第 4 天，卖出第 5 天利润 = 0 - 2 = -2
    在这些情况中，利润最大 = 3。

解题思路：动态规划

状态定义：

dp[i][0] 表示第 i 天结束后，手里没有股票的最大利润。

dp[i][1] 表示第 i 天结束后，手里持有股票的最大利润。

状态转移：

对于 dp[i][0]，有两种情况：

1.第 i 天结束后，手里没有股票，可能是前一天也没有股票，也可能是前一天有股票，今天卖了。

dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])

2.第 i 天结束后，手里有股票，今天什么也不做。

dp[i][1] = max(dp[i-1][1], dp[i-2][0] - prices[i])

解释：dp[i-2][0] 表示的是第 i-2 天结束后，手里没有股票的最大利润，因为有冷冻期，所以第 i-1 天不能买入股票。

对于 dp[i][1]，有两种情况：

1.第 i 天结束后，手里有股票，可能是前一天也有股票，也可能是前一天没有股票，今天买了。

dp[i][1] = max(dp[i-1][1], dp[i-1][0] - prices[i])

2.第 i 天结束后，手里没有股票，今天什么也不做。

dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])

最终答案为 dp[n-1][0]，其中 n 为数组的长度。

解决方案：

```go
func maxProfit(prices []int) int {
    n := len(prices)
    if n == 0 {
        return 0
    }
    dp := make([][2]int, n)
    dp[0][0], dp[0][1] = 0, -prices[0]
    for i := 1; i < n; i++ {
        dp[i][0] = max(dp[i-1][0], dp[i-1][1]+prices[i])
        if i >= 2 {
            dp[i][1] = max(dp[i-1][1], dp[i-2][0]-prices[i])
        } else {
            dp[i][1] = max(dp[i-1][1], -prices[i])
        }
    }
    return dp[n-1][0]
}

func max(a, b int) int {
    if a > b {
        return a
    }
    return b
}
```

算法复杂度：时间复杂度 O(n)，空间复杂度 O(n)。