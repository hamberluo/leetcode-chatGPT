题目编号：885

题目：螺旋矩阵 III

难度：中等

考察范围：数组、模拟

题干：在 R \times C 的矩阵上，我们从 (r0, c0) 面朝东面开始

这里给出一个例子，当 R = 5 且 C = 6 时的螺旋矩阵：


解题思路：模拟

我们可以按照题目要求，从起始点开始，按照顺序依次访问每个点，直到访问完所有点。

具体来说，我们可以维护当前位置 (r, c) 和前进方向 di，其中 di 的取值范围为 0, 1, 2, 3 表示向东、向南、向西、向北四个方向。

我们从起始点 (r_0, c_0) 开始，不断移动位置，直到访问完所有的 R \times C 个位置。由于我们总是沿着当前方向前进，因此前进的过程中不需要改变方向，只需要在移动到下一个位置后判断是否越界即可。

具体而言，设当前位置为 (r, c)，前进方向为 di，我们希望访问下一个位置 (nr, nc)。根据当前方向 di，我们可以将其分为以下四种情况：

当 di=0 时，下一个位置为 (r, c+1)；
当 di=1 时，下一个位置为 (r+1, c)；
当 di=2 时，下一个位置为 (r, c-1)；
当 di=3 时，下一个位置为 (r-1, c)。

在实际代码中，我们可以将 di 的取值范围改为 0, 1, -1, 2，这样方便我们通过取模运算实现在四个方向之间的循环。

解决方案：

```dart
class Solution {
  List<List<int>> spiralMatrixIII(int R, int C, int r0, int c0) {
    int[][] dirs = {{0, 1}, {1, 0}, {0, -1}, {-1, 0}};
    List<List<int>> res = new List<List<int>>();
    int len = R * C, r = r0, c = c0, di = 0, t = 0;
    res.add([r, c]);
    while (res.length < len) {
      t++;
      for (int i = 0; i < t; i++) {
        r += dirs[di][0];
        c += dirs[di][1];
        if (r >= 0 && r < R && c >= 0 && c < C) {
          res.add([r, c]);
        }
      }
      di = (di + 1) % 4;
    }
    return res;
  }
}
```

算法复杂度：时间复杂度为 O(RC)，空间复杂度为 O(RC)。