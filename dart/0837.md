题目编号：837

题目：新21点

难度：中等

考察范围：动态规划

题干：爱丽丝以 0 分开始，并在她的得分少于 K 分时抽取数字。 抽取时，她从牌堆顶部抽取一张牌，使得她的分数增加牌面的点数。 除非她打出 21 点，否则她不能再拿牌。 这个游戏的目标是使她的得分最大化，并使得她的得分不超过 K。 如果她得到了最大的得分，就可以获得奖励。

给定一个整数 K，以及一个整数 W，代表牌堆中总共有 W 张牌。 请返回爱丽丝能够获得的最大得分。

解题思路：动态规划

我们可以用 dp[x] 表示从得分为 x 的情况开始游戏并且获胜的概率，目标是求 dp[0] 的值。

根据规则，当分数达到 K 时就停止抽牌，然后比较分数与 W 的大小关系即可。

当 K ≤ x 时，停止抽牌，分数不再增加，此时 dp[x] = 1.0。

当 x > W 时，停止抽牌，分数不再增加，此时 dp[x] = 0.0。

当 x ∈ [K, W] 时，可以抽到的牌面是 [1, W]，因此有 dp[x] = (dp[x+1] + dp[x+2] + ... + dp[x+W]) / W。

最终答案即为 dp[0]。

解决方案：

```dart
double new21Game(int N, int K, int W) {
  if (K == 0) {
    return 1.0;
  }
  List<double> dp = List.filled(K + W, 0.0);
  for (int i = K; i <= N && i < K + W; i++) {
    dp[i] = 1.0;
  }
  dp[K - 1] = 1.0 * (N - K + 1) / W;
  for (int i = K - 2; i >= 0; i--) {
    dp[i] = dp[i + 1] - (dp[i + W + 1] - dp[i + 1]) / W;
  }
  return dp[0];
}
```

算法复杂度：时间复杂度 O(K + W)，空间复杂度 O(K + W)。