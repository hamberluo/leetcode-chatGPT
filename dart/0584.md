题目编号：584

题目：寻找用户推荐人

难度：简单

考察范围：哈希表、树

题干：给定一个员工表，包含员工编号（Id）和他们的上级。每个员工都有一个直接上级，除了公司的最高级别boss，没有任何人的上级。它是公司唯一的员工。对于这个表，编写一个 SQL 查询，找出每个员工的直接上级。

+----+-------+
| Id | Name  |
+----+-------+
| 1  | Joe   |
| 2  | Henry |
| 3  | Sam   |
| 4  | Max   |
+----+-------+
+-----------+-----------+
| Employee  | Supervisor|
+-----------+-----------+
| 1         | 2         |
| 2         | 3         |
| 3         | NULL      |
| 4         | 3         |
+-----------+-----------+

解题思路：使用自连接查询，将员工表和上级表连接起来，查询每个员工的上级。

解决方案：

```sql
SELECT e.Name AS Employee, s.Name AS Supervisor
FROM Employee e LEFT JOIN Employee s ON e.SuperiorId = s.Id
```

算法复杂度：时间复杂度 O(n)，空间复杂度 O(1)。