题目编号：858

题目：镜面反射

难度：中等

考察范围：数学、几何

题干：有一个无限长的数字串，从左到右依次为 1, 2, 3, ...。现在有一个小球从左边开始沿着数字串向右移动，每次可以向右移动一个单位长度或者向右上方移动一个单位长度或者向右下方移动一个单位长度。当小球移动到数字串的最右端时，如果小球在第偶数次移动时向右上方移动，那么小球会被反射回来，向右下方移动；如果小球在第奇数次移动时向右下方移动，那么小球会被反射回来，向右上方移动。现在给定小球的起始位置和移动次数，求小球最终到达的位置。

解题思路：本题可以通过数学方法求解。首先，我们可以将数字串看作是一个坐标系，每个数字对应一个点，坐标为 (i, 0)，其中 i 表示数字的位置。小球的起始位置和移动次数也可以看作是坐标系中的一个点和一个向量。我们可以通过计算小球最终到达的位置的坐标来求解本题。

我们可以将小球的移动分解为两个方向：向右和向上或向下。向右的距离可以直接计算，而向上或向下的距离可以通过计算小球到达最右端时向右上方或向右下方移动的次数来确定。设小球到达最右端时向右上方移动的次数为 k，则小球到达最右端时向右下方移动的次数为 k+1。因此，我们可以通过计算小球到达最右端时向右上方或向右下方移动的次数来确定小球最终到达的位置。

解决方案：

```rust
impl Solution {
    pub fn mirror_reflection(p: i32, q: i32) -> i32 {
        let k = Self::gcd(p, q);
        let m = p / k;
        let n = q / k;
        if m % 2 == 0 {
            2
        } else if n % 2 == 0 {
            0
        } else {
            1
        }
    }

    fn gcd(a: i32, b: i32) -> i32 {
        if b == 0 {
            a
        } else {
            Self::gcd(b, a % b)
        }
    }
}
```

算法复杂度：本算法的时间复杂度为 O(log(min(p, q)))，空间复杂度为 O(1)。其中，log(min(p, q)) 表示 p 和 q 的最大公约数的位数。