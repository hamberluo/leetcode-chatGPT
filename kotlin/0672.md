题目编号：672

题目：灯泡开关 Ⅱ

难度：中等

考察范围：数学、逻辑

题干：有一个房间，墙上挂有 n 只已经打开的灯泡和 4 个按钮。在进行了 m 次未知操作后，你需要返回这 n 只灯泡可能有多少种不同的状态。假设这 n 只灯泡初始状态都是关闭的。

操作 1：将所有灯泡的状态反转（即开变为关，关变为开）
操作 2：将编号为偶数的灯泡的状态反转
操作 3：将编号为奇数的灯泡的状态反转
操作 4：将编号为 3k+1 的灯泡的状态反转（k = 0, 1, 2, ...)

解题思路：通过观察题目，我们可以发现，操作 1 和操作 2、3 的效果是一样的，即操作 1 可以被操作 2、3 替代。因此，我们只需要考虑操作 2、3、4 的效果即可。

对于操作 2，我们可以将其看作是每隔一个灯泡进行反转，即第 2、4、6、8、... 号灯泡进行反转。同理，对于操作 3，我们可以将其看作是每隔一个灯泡进行反转，即第 1、3、5、7、... 号灯泡进行反转。对于操作 4，我们可以将其看作是每隔三个灯泡进行反转，即第 1、4、7、10、... 号灯泡进行反转。

因此，我们可以分别计算进行了 0、1、2、3 次操作后，每个灯泡的状态，最后将所有可能的状态进行统计即可。

解决方案：

```kotlin
class Solution {
    fun flipLights(n: Int, m: Int): Int {
        // 特判
        if (n == 0 || m == 0) {
            return 1
        }
        if (n == 1) {
            return 2
        }
        if (n == 2) {
            return if (m == 1) 3 else 4
        }
        if (m == 1) {
            return 4
        }
        return if (m == 2) 7 else 8
    }
}
```

算法复杂度：时间复杂度为 O(1)，空间复杂度为 O(1)。