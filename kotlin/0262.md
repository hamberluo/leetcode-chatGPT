题目编号：262

题目：行程和用户

难度：中等

考察范围：哈希表、字符串

题干：给出如下表格 trips，其中 trip_id 是每一趟行程的唯一标识符，client_id 是用户标识符，timestamp 是此行程的时间戳，以秒为单位，start_city 是行程起点城市，end_city 是行程终点城市，而 trip_distance 是行程的距离。

+----+-----------+----------+------------------+-------------+----------------+
| Id | Client_Id |   Date   |    City_Start    |  City_End   | Trip_Distance  |
+----+-----------+----------+------------------+-------------+----------------+
| 1  |     1     |2019-01-01|      New York    |     LA      |     240        |
| 2  |     1     |2019-01-01|      New York    |     LA      |     240        |
| 3  |     1     |2019-01-01|      New York    |     LA      |     240        |
| 4  |     2     |2019-01-01|      New York    |     LA      |     240        |
| 5  |     2     |2019-01-01|      New York    |     LA      |     240        |
| 6  |     3     |2019-01-01|      New York    |     LA      |     240        |
| 7  |     3     |2019-01-01|      New York    |     LA      |     240        |
+----+-----------+----------+------------------+-------------+----------------+

编写一个 SQL 查询，找出每个用户最近的行程，以及行程距离。查询结果如下所示：

+-----------+-------------+----------------+
| client_id | maxDate     | sumDistance    |
+-----------+-------------+----------------+
| 1         | 2019-01-01  |  720           |
| 2         | 2019-01-01  |  480           |
| 3         | 2019-01-01  |  480           |
+-----------+-------------+----------------+

解题思路：使用 GROUP BY 对 client_id 进行分组，然后使用 MAX 函数找出每个用户最近的行程时间，使用 SUM 函数计算每个用户的行程距离。

解决方案：

```kotlin
SELECT 
    client_id, 
    MAX(Date) AS maxDate, 
    SUM(Trip_Distance) AS sumDistance
FROM 
    trips
GROUP BY 
    client_id;
```

算法复杂度：时间复杂度 O(n)，空间复杂度 O(n)。