题目编号：858

题目：镜面反射

难度：中等

考察范围：数学、几何

题干：有一个光源、一个起点和一个终点，光线从起点沿着直线向终点移动。在其路径中，光线与一些镜面进行反射。例如，光线与镜面 1 反射，然后与镜面 2 反射，然后最终抵达终点。

每次反射时，光线会向右或向左移动，具体取决于下一个镜面是凸面还是凹面。我们将光源视为在坐标 (0, 0) 处，将起点视为在坐标 (p, 0) 处，将终点视为在坐标 (q, 0) 处，其中 p > 0 且 q > p。

镜面按照其在 x 轴上的位置给出，位置 x 处的镜面的凸凹性质由字符串 mirrors[x - 1] 给出，如果该位置的镜面是凸面，则为 "/"，如果是凹面，则为 "\"。

给出表示每个镜面凸凹性质的字符串 mirrors，以及起点和终点的坐标 p 和 q，返回光线的最终抵达位置。

解题思路：根据题目描述，我们可以发现，光线在每次反射时，都会向右或向左移动，具体取决于下一个镜面是凸面还是凹面。因此，我们可以通过模拟光线的移动过程，来求出光线的最终抵达位置。

具体来说，我们可以从起点开始，向右或向左移动，直到碰到第一个镜面。然后，根据镜面的凸凹性质，来决定光线的反射方向。如果镜面是凸面，则光线向左反射；如果镜面是凹面，则光线向右反射。然后，我们继续向反射方向移动，直到碰到下一个镜面，重复上述过程，直到光线抵达终点。

解决方案：

```kotlin
class Solution {
    fun mirrorReflection(p: Int, q: Int): Int {
        var x = 0 // 光线的横坐标
        var y = 0 // 光线的纵坐标
        var dx = p // 光线的横向移动距离
        var dy = q // 光线的纵向移动距离
        var dir = 1 // 光线的方向，1 表示向右，-1 表示向左

        while (true) {
            // 如果光线到达了终点，则返回光线所在的墙壁编号
            if (y == 0 && x == p) {
                return 0
            } else if (y == q && x == p) {
                return 1
            } else if (y == q && x == 0) {
                return 2
            }

            // 计算光线与下一个镜面的交点
            var t = Int.MAX_VALUE
            if (dy > 0) {
                t = Math.min(t, (q - y) / dy)
            }
            if (dy < 0) {
                t = Math.min(t, -y / dy)
            }
            if (dx > 0) {
                t = Math.min(t, (p - x) / dx)
            }
            if (dx < 0) {
                t = Math.min(t, -x / dx)
            }

            // 更新光线的位置
            x += dx * t
            y += dy * t

            // 如果光线到达了终点，则返回光线所在的墙壁编号
            if (y == 0 && x == p) {
                return 0
            } else if (y == q && x == p) {
                return 1
            } else if (y == q && x == 0) {
                return 2
            }

            // 更新光线的方向
            if (y == 0 || y == q) {
                dx = -dx
                dir = -dir
            } else {
                dy = -dy
            }
        }
    }
}
```

算法复杂度：时间复杂度为 O(p)，空间复杂度为 O(1)。