题目编号：552

题目：学生出勤记录 II

难度：困难

考察范围：动态规划

题干：给定一个正整数 n，表示学生的出勤记录表的大小。记录表中第 i 条记录代表第 i 天学生的出勤情况，共有三个字符（"A"、"L" 和 "P"）：

"A"：Absent，缺勤
"L"：Late，迟到
"P"：Present，到场

如果学生能够同时满足下面两个条件，则可以获得出勤奖励：

按出勤记录表中的记录，学生缺勤（"A"）严格少于两天。
学生不会存在连续 3 天或 3 天以上的迟到（"L"）记录。
给定一个整数 n，返回记录长度为 n 时，可能获得出勤奖励的记录情况数量。答案可能非常大，所以返回对 10^9 + 7 取余的结果。

解题思路：本题可以使用动态规划来解决。我们可以定义一个三维数组 dp[i][j][k]，其中 i 表示当前考虑到第 i 天，j 表示当前缺勤的天数，k 表示当前连续迟到的天数。那么状态转移方程如下：

dp[i][j][0] = dp[i-1][j][0] + dp[i-1][j][1] + dp[i-1][j][2] （今天是P）
dp[i][j][1] = dp[i-1][j][0] （今天是L）
dp[i][j][2] = dp[i-1][j][1] （今天是L）
dp[i][j+1][0] = dp[i-1][j][0] + dp[i-1][j][1] + dp[i-1][j][2] （今天是A）

其中，dp[i][j][0] 表示第 i 天缺勤 j 天且不连续迟到的方案数，dp[i][j][1] 表示第 i 天缺勤 j 天且以第 i 天为结尾连续迟到 1 天的方案数，dp[i][j][2] 表示第 i 天缺勤 j 天且以第 i 天为结尾连续迟到 2 天的方案数，dp[i][j+1][0] 表示第 i 天缺勤 j+1 天的方案数。

最终的答案即为 dp[n][0][0] + dp[n][0][1] + dp[n][0][2]。

解决方案：

```java
class Solution {
    public int checkRecord(int n) {
        int mod = 1000000007;
        int[][][] dp = new int[n+1][2][3];
        dp[0][0][0] = 1;
        for (int i = 1; i <= n; i++) {
            // 今天是P
            for (int j = 0; j <= 1; j++) {
                for (int k = 0; k <= 2; k++) {
                    dp[i][j][0] = (dp[i][j][0] + dp[i-1][j][k]) % mod;
                }
            }
            // 今天是L
            for (int j = 0; j <= 1; j++) {
                for (int k = 1; k <= 2; k++) {
                    dp[i][j][k] = dp[i-1][j][k-1];
                }
            }
            // 今天是A
            for (int k = 0; k <= 2; k++) {
                dp[i][1][0] = (dp[i][1][0] + dp[i-1][0][k]) % mod;
            }
        }
        int res = 0;
        for (int j = 0; j <= 1; j++) {
            for (int k = 0; k <= 2; k++) {
                res = (res + dp[n][j][k]) % mod;
            }
        }
        return res;
    }
}
```

算法复杂度：时间复杂度为 O(n)，空间复杂度为 O(n)。